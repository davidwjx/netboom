/****************************************************************************
 *
 *   FileName: que.c
 *
 *   Author: 
 *
 *   Date:
 *
 *   Description: simple que implementation
 *
 ****************************************************************************/

/****************************************************************************
 ***************               I N C L U D E   F I L E S        *************
 ****************************************************************************/
#include "inu_types.h"
#include "que.h"
#include "log.h"

#ifdef __cplusplus
      extern "C" {
#endif

/****************************************************************************
 ***************         L O C A L       D E F N I T I O N S  ***************
 ****************************************************************************/

/****************************************************************************
 ***************            L O C A L    T Y P E D E F S      ***************
 ****************************************************************************/

/****************************************************************************
 ***************     P R E    D E F I N I T I O N     OF      ***************
 ***************     L O C A L         F U N C T I O N S      ***************
 ****************************************************************************/

/****************************************************************************
 ***************       L O C A L         D A T A              ***************
 ****************************************************************************/

/****************************************************************************
 ***************       G L O B A L       D A T A              ***************
 ****************************************************************************/

/****************************************************************************
 ***************      L O C A L       F U N C T I O N S       ***************
 ****************************************************************************/

/****************************************************************************
 ***************     G L O B A L         F U N C T I O N S    ***************
 ****************************************************************************/
 void QUEG_init(QUEG_queT *queP)
 {
    queP->head = 0;
    queP->tail = queP->head;
    queP->cnt = 0;
 }

 int QUEG_enque(QUEG_queT *queP, QUEG_elemT elem)
 {
    if(queP->cnt >= queP->maxCnt)
    {
       return (-1);
    }
    else
    {
       queP->que[queP->tail] = elem;
       queP->tail = (queP->tail == (QUEG_MAX_ELEMENTS-1)) ? 0 : (queP->tail+1);
       queP->cnt++;
    }

    return 0;
 }

int QUEG_deque(QUEG_queT *queP, QUEG_elemT *elemP)
{
   if(queP->cnt == 0)
   {
      return (-1);
   }
   else
   {
      *elemP = queP->que[queP->head];
      queP->head = (queP->head == (QUEG_MAX_ELEMENTS-1)) ? 0 : (queP->head+1);
      queP->cnt--;
   }
   return 0;
}

unsigned int QUEG_numElements(QUEG_queT *queP)
{
   return queP->cnt;
}

void QUEG_show(QUEG_queT *queP)
{
   unsigned int i;
   unsigned int idx;
   LOGG_PRINT(LOG_INFO_E, NULL, "que: head=%d tail= %d cnt=%d (max=%d)\n", queP->head, queP->tail, queP->cnt, queP->maxCnt);
   for(i = 0; i < queP->cnt; i++)
   {
      idx = (queP->head + i) % (QUEG_MAX_ELEMENTS);
      LOGG_PRINT(LOG_INFO_E, NULL, "[%d] %p\n", idx, queP->que[idx]);
   }
}

#ifdef __cplusplus
}
#endif

